DROP TABLE IF EXISTS SY_ITEM_TLITEM;
CREATE TABLE SY_ITEM_TLITEM AS
SELECT
	SY_TEST_ITEMS.ITEM_ID
	, SY_TEST_ITEMS.CAT_ID
	, SY_ITEM_TERMS.TERMMS
	, TLITEM_ID
	, TLITEM_TERMMS
	, TLITEM_DPITEMS
FROM SY_TEST_ITEMS
LEFT OUTER JOIN SY_ITEM_TERMS
ON SY_TEST_ITEMS.ITEM_ID = SY_ITEM_TERMS.ITEM_ID
INNER JOIN
(
	SELECT
		SY_ITEM_TERMS.ITEM_ID AS TLITEM_ID
		, SY_ITEM_TERMS.CAT_ID AS TLITEM_CAT_ID
		, TERMMS AS TLITEM_TERMMS
		, DPITEMS AS TLITEM_DPITEMS
	FROM SY_ITEM_TERMS
	INNER OUTER JOIN SY_ITEM_DPITEMS
	ON SY_ITEM_TERMS.ITEM_ID = SY_ITEM_DPITEMS.ITEM_ID
)A
ON SY_TEST_ITEMS.CAT_ID = A.TLITEM_CAT_ID;

DROP TABLE IF EXISTS SY_ITEM_YBITEM1;
CREATE TABLE SY_ITEM_YBITEM1
(
	ITEM_ID BIGINT
	, HXITEM_ID BIGINT
	, HXITEM_DPD DOUBLE
);
JAR -libjars SY_YC1_YB.jar;

DROP TABLE IF EXISTS SY_ITEM_HXITEM1;
CREATE TABLE SY_ITEM_HXITEM1 AS
SELECT
	ITEM_ID
	, HXITEM_ID
	, HXITEM_DPD
	, HXITEM_TCS
FROM SY_ITEM_YYCITEM1
LEFT OUTER JOIN
(
	SELECT 
		ITEM_ID AS AITEM_ID
		, COUNT(DISTINCT COLL_ID) AS HXITEM_TCS
	FROM SY_ITEM_DPITEM
	GROUP BY ITEM_ID
)A
ON SY_ITEM_YBITEM1.HXITEM_ID = A.AITEM_ID;

DROP TABLE IF EXISTS SY_ITEM_YCITEM1;
CREATE TABLE SY_ITEM_YCITEM1
(
	ITEM_ID BIGINT
	, YCITEM_ID BIGINT
	, YCITEM_DPD DOUBLE
);

JAR -libjars SY_YC1.jar;